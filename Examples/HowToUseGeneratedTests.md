# How to Use Generated Test Scripts

This guide shows you how to use the test scripts generated by the Test Automation Platform.

## Step 1: Generate Your Test Script

1. Open the Test Automation Platform at `http://localhost:5000`
2. Navigate to the **Test Script Generator** tab
3. Describe your UI or use the example
4. Select your test framework
5. Click **Generate Test Scripts**
6. Copy or download the generated code

## Step 2: Create a Test Project

### For XUnit (Recommended)

```powershell
# Create a new XUnit test project
dotnet new xunit -n MyApp.AutomatedTests
cd MyApp.AutomatedTests

# Add required NuGet packages
dotnet add package Selenium.WebDriver
dotnet add package Selenium.WebDriver.ChromeDriver
dotnet add package Selenium.Support
```

### For NUnit

```powershell
dotnet new nunit -n MyApp.AutomatedTests
cd MyApp.AutomatedTests
dotnet add package Selenium.WebDriver
dotnet add package Selenium.WebDriver.ChromeDriver
dotnet add package Selenium.Support
```

### For Playwright

```powershell
dotnet new nunit -n MyApp.AutomatedTests
cd MyApp.AutomatedTests
dotnet add package Microsoft.Playwright.NUnit
pwsh bin/Debug/net8.0/playwright.ps1 install
```

## Step 3: Add the Generated Test Code

1. Create a new `.cs` file in your test project (e.g., `AccountFormTests.cs`)
2. Paste the generated test code
3. Adjust the namespace if needed

## Step 4: Run the Tests

### Using Command Line

```powershell
dotnet test
```

### Using Visual Studio

1. Open Test Explorer (Test > Test Explorer)
2. Click "Run All"

### Using VS Code

1. Install the .NET Test Explorer extension
2. Click the test icon in the sidebar
3. Run individual or all tests

## Step 5: View Results

Test results will show:
- ✅ Passed tests (green)
- ❌ Failed tests (red)
- Execution time
- Error messages for failures

## Example Project Structure

```
MyApp.AutomatedTests/
├── AccountFormTests.cs          # Generated test for account form
├── LoginTests.cs                # Generated test for login
├── DashboardTests.cs            # Generated test for dashboard
├── PageObjects/                 # Optional: Page Object Model
│   ├── AccountFormPage.cs
│   └── LoginPage.cs
├── Utilities/                   # Optional: Helper classes
│   ├── WebDriverFactory.cs
│   └── TestDataGenerator.cs
└── MyApp.AutomatedTests.csproj
```

## Customizing Generated Tests

### Add Test Data

```csharp
public class TestData
{
    public static IEnumerable<object[]> ValidAccounts()
    {
        yield return new object[] { "John", "Doe", "john@example.com" };
        yield return new object[] { "Jane", "Smith", "jane@example.com" };
    }
}

[Theory]
[MemberData(nameof(TestData.ValidAccounts), MemberType = typeof(TestData))]
public void Test_CreateAccount_WithMultipleUsers(string firstName, string lastName, string email)
{
    // Use the test data
}
```

### Add Page Object Model

```csharp
public class AccountFormPage
{
    private readonly IWebDriver _driver;

    public AccountFormPage(IWebDriver driver)
    {
        _driver = driver;
    }

    public void FillFirstName(string firstName)
    {
        _driver.FindElement(By.Id("firstName")).SendKeys(firstName);
    }

    public void FillLastName(string lastName)
    {
        _driver.FindElement(By.Id("lastName")).SendKeys(lastName);
    }

    public void Submit()
    {
        _driver.FindElement(By.CssSelector("button[type='submit']")).Click();
    }
}
```

### Add Configuration

Create `appsettings.json`:

```json
{
  "TestSettings": {
    "BaseUrl": "http://localhost:5000",
    "Browser": "Chrome",
    "ImplicitWait": 10,
    "ExplicitWait": 30
  }
}
```

## Best Practices

### 1. Use Setup and Teardown

```csharp
public class BaseTest : IDisposable
{
    protected IWebDriver Driver;

    public BaseTest()
    {
        Driver = new ChromeDriver();
        Driver.Manage().Window.Maximize();
    }

    public void Dispose()
    {
        Driver?.Quit();
        Driver?.Dispose();
    }
}
```

### 2. Add Explicit Waits

```csharp
var wait = new WebDriverWait(_driver, TimeSpan.FromSeconds(10));
wait.Until(d => d.FindElement(By.Id("element")));
```

### 3. Take Screenshots on Failure

```csharp
public void TakeScreenshot(string testName)
{
    var screenshot = ((ITakesScreenshot)_driver).GetScreenshot();
    screenshot.SaveAsFile($"Screenshots/{testName}_{DateTime.Now:yyyyMMdd_HHmmss}.png");
}
```

### 4. Use Meaningful Assertions

```csharp
// Good
Assert.Equal("Account created successfully!", successMessage);

// Better
Assert.Contains("successfully", successMessage, StringComparison.OrdinalIgnoreCase);
```

### 5. Organize Tests by Feature

```
Tests/
├── AccountManagement/
│   ├── CreateAccountTests.cs
│   ├── UpdateAccountTests.cs
│   └── DeleteAccountTests.cs
├── Authentication/
│   ├── LoginTests.cs
│   └── LogoutTests.cs
└── Dashboard/
    └── DashboardTests.cs
```

## Running Tests in CI/CD

### GitHub Actions

```yaml
name: Run Tests

on: [push, pull_request]

jobs:
  test:
    runs-on: windows-latest
    steps:
      - uses: actions/checkout@v2
      - name: Setup .NET
        uses: actions/setup-dotnet@v1
        with:
          dotnet-version: 8.0.x
      - name: Run tests
        run: dotnet test
```

### Azure DevOps

```yaml
trigger:
  - main

pool:
  vmImage: 'windows-latest'

steps:
  - task: UseDotNet@2
    inputs:
      version: '8.0.x'
  - script: dotnet test
    displayName: 'Run Tests'
```

## Troubleshooting

### ChromeDriver Version Mismatch

```powershell
dotnet add package Selenium.WebDriver.ChromeDriver --version [your-chrome-version]
```

### Element Not Found

Add explicit waits:
```csharp
var wait = new WebDriverWait(_driver, TimeSpan.FromSeconds(10));
var element = wait.Until(d => d.FindElement(By.Id("elementId")));
```

### Tests Running Slowly

- Use headless mode for faster execution
- Reduce implicit/explicit wait times
- Run tests in parallel

```csharp
var options = new ChromeOptions();
options.AddArgument("--headless");
var driver = new ChromeDriver(options);
```

## Next Steps

1. **Refactor**: Convert to Page Object Model
2. **Extend**: Add more test scenarios
3. **Integrate**: Add to CI/CD pipeline
4. **Report**: Generate HTML test reports
5. **Monitor**: Track test execution metrics

---

**Happy Testing! 🎉**
